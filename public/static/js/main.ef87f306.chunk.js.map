{"version":3,"sources":["utils/index.ts","compoents/RuleForm/index.tsx","pages/creator.tsx","pages/settings.tsx","pages/upload.tsx","pages/list.tsx","pages/localCode.tsx","pages/editPackage.tsx","router.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["getRuleReg","rule","prefix","content","suffix","Setting","props","onConfirm","useState","setRule","useForm","form","useEffect","setFieldsValue","style","textAlign","width","margin","backgroundColor","padding","onFinish","labelCol","span","onValuesChange","cv","av","Item","name","label","required","color","fontWeight","placeholder","type","htmlType","TabPane","safeStr","str","replace","showCode","code","currentFormItem","rs","Object","keys","forEach","item","RegExp","exportTemplate","file","formValue","blob","Blob","outputCode","saveAs","Creator","history","useHistory","useParams","version","author","description","files","detail","setDetail","Axios","get","then","res","data","setCode","setFiles","readmes","setReadmes","error","setTimeout","push","createForm","length","all","map","template","url","spread","index","setCodeCtn","readme","console","log","setIndex","Number","Prism","highlightAll","formValues","setFormValues","match","newFormValues","array","has","undefined","outputFormValue","resetFields","handleValueChange","useCallback","changeValue","setCurrentFormItem","renderForm","key","onFocus","formElement","useMemo","visible","setVisible","tempCode","setTempCode","dvisible","setDVisible","display","height","flex","flexDirection","overflow","headStyle","flexShrink","title","extra","onClick","text","onCopy","success","exportPatch","defaultActiveKey","String","onChange","tab","className","split","dangerouslySetInnerHTML","__html","DOMPurify","sanitize","marked","marginLeft","onSelect","value","handleExtendsFormValues","allowClear","i","Option","disabled","placement","closable","onClose","RuleForm","onOk","onCancel","TextArea","target","autoSize","minRows","updateSetting","values","axios","post","MyUpload","others","info","status","fileList","response","onRemove","UploadOutlined","TemplateUpload","uploadConfig","action","overflowY","alignItems","justifyContent","message","rules","List","fields","add","remove","field","accept","MinusCircleOutlined","marginTop","PlusOutlined","list","setList","query","setQuery","size","filter","indexOf","xs","sm","md","lg","actions","EditOutlined","e","stopPropagation","React","createElement","defaultFileList","uid","fileName","ajaxing","setAjaxing","myPackage","fontSize","Routes","exact","path","App","Header","overlay","href","marginRight","mode","theme","to","Content","Boolean","window","location","hostname","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.ef87f306.chunk.js","sourcesContent":["export function getRuleReg(rule: Rule) {\n  if (rule.prefix && rule.content && rule.suffix) {\n    return `(?<=${rule.prefix})(${rule.content}*?)(?=${rule.suffix})`;\n  }\n  return '';\n}\n","import React, { useEffect, useState } from 'react';\nimport { Form, Input, Button } from 'antd';\n\ninterface RuleForm extends Rule {\n  onConfirm(values: any): void;\n}\n\nconst Setting: React.FC<RuleForm> = (props) => {\n  const { onConfirm, prefix, content, suffix } = props;\n  const [rule, setRule] = useState({\n    prefix: '',\n    content: '',\n    suffix: '',\n  });\n  const [form] = Form.useForm();\n  useEffect(() => {\n    setRule({\n      prefix,\n      content,\n      suffix,\n    });\n    form.setFieldsValue({\n      prefix,\n      content,\n      suffix,\n    });\n  }, [prefix, content, suffix]);\n  return (\n    <div style={{ textAlign: 'center' }}>\n      <div\n        style={{\n          width: '100%',\n          margin: '0 auto',\n          backgroundColor: '#fff',\n          padding: 20,\n        }}\n      >\n        <h2>规则设置</h2>\n        <Form\n          form={form}\n          onFinish={onConfirm}\n          labelCol={{ span: 6 }}\n          onValuesChange={(cv, av: any) => setRule(av)}\n        >\n          <Form.Item name=\"prefix\" label=\"前缀\" required>\n            <Input\n              prefix={\n                <span style={{ color: '#1890ff', fontWeight: 'bold' }}>\n                  {'/(?<='}\n                </span>\n              }\n              suffix={\n                <span style={{ color: '#1890ff', fontWeight: 'bold' }}>)</span>\n              }\n              placeholder=\"前匹配\"\n            ></Input>\n          </Form.Item>\n          <Form.Item name=\"content\" label=\"匹配\" required>\n            <Input\n              prefix={\n                <span style={{ color: '#1890ff', fontWeight: 'bold' }}>(</span>\n              }\n              suffix={\n                <span style={{ color: '#1890ff', fontWeight: 'bold' }}>\n                  *?)\n                </span>\n              }\n              placeholder=\"请输入正确的正则表达式\"\n            ></Input>\n          </Form.Item>\n          <Form.Item name=\"suffix\" label=\"后缀\" required>\n            <Input\n              prefix={\n                <span style={{ color: '#1890ff', fontWeight: 'bold' }}>\n                  (?=\n                </span>\n              }\n              suffix={\n                <span style={{ color: '#1890ff', fontWeight: 'bold' }}>\n                  )/gm\n                </span>\n              }\n              placeholder=\"后匹配\"\n            ></Input>\n          </Form.Item>\n          <Form.Item label=\"预览\">\n            <div style={{ color: 'red', textAlign: 'left' }}>\n              {`/(?<=${rule.prefix})(${rule.content}*?)(?=${rule.suffix})/gm`}\n            </div>\n          </Form.Item>\n          <Form.Item>\n            <Button type=\"primary\" htmlType=\"submit\">\n              保存\n            </Button>\n          </Form.Item>\n        </Form>\n      </div>\n    </div>\n  );\n};\n\nexport default Setting;\n","import React, { useEffect, useState, useCallback, useMemo } from 'react';\nimport {\n  Form,\n  Input,\n  Modal,\n  Button,\n  message,\n  Card,\n  Tabs,\n  Descriptions,\n  Select,\n  Drawer,\n} from 'antd';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport { useParams, useHistory } from 'react-router-dom';\nimport Axios from 'axios';\nimport { saveAs } from 'file-saver';\nimport marked from 'marked';\nimport DOMPurify from 'dompurify';\nimport { getRuleReg } from '../utils/index';\nimport { Package } from './types';\nimport RuleForm from '../compoents/RuleForm';\n\nconst { TabPane } = Tabs;\n\ninterface FileItem {\n  name: string;\n  code: string;\n  description: string;\n}\n\ninterface ReadmeItem {\n  name: string;\n  content: string;\n}\ntype ReadmeNullItem = ReadmeItem | null;\n\nfunction outputFormValue(array: string[]) {\n  const has: Record<string, string> = {};\n  array.forEach((item) => {\n    if (has[item] === undefined) {\n      has[item] = '';\n    }\n  });\n  return has;\n}\n\nfunction safeStr(str: string) {\n  return str\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#039;');\n}\n\nfunction showCode(\n  form: Record<string, string>,\n  code: string,\n  currentFormItem = '',\n  rule = {\n    prefix: '{{',\n    suffix: '}}',\n  }\n) {\n  if (code && form) {\n    let rs = safeStr(code);\n\n    // console.log(DOMPurify.sanitize(rs, { USE_PROFILES: { html: true } }), rs);\n    Object.keys(form).forEach((item) => {\n      rs = rs.replace(\n        new RegExp(`${rule.prefix}${item}${rule.suffix}`, 'gm'),\n        `<span class=\"slot-${item} ${\n          item === currentFormItem ? 'actived-code' : ''\n        }\">${form[item] || ' '}</span>`\n      );\n    });\n    return rs;\n  }\n  return '';\n}\n\n/** 导出模版 */\nfunction exportTemplate(\n  file: FileItem,\n  formValue: Record<string, string>,\n  rule = {\n    prefix: '{{',\n    suffix: '}}',\n  }\n) {\n  const blob = new Blob([outputCode(formValue, file.code, rule)], {\n    type: 'text/plain;charset=utf-8',\n  });\n  saveAs(blob, file.name);\n}\nfunction exportPatch(\n  files: FileItem[],\n  formValues: Record<string, string>[],\n  rule = {\n    prefix: '{{',\n    suffix: '}}',\n  }\n) {\n  files.forEach((item, index) => {\n    exportTemplate(item, formValues[index], rule);\n  });\n}\n\nfunction outputCode(\n  form: Record<string, string> = {},\n  code: string = '',\n  rule = {\n    prefix: '{{',\n    suffix: '}}',\n  }\n) {\n  let rs = code;\n  Object.keys(form).forEach((item) => {\n    rs = rs.replace(\n      new RegExp(`${rule.prefix}${item}${rule.suffix}`, 'gm'),\n      form[item]\n    );\n  });\n  return rs;\n}\n\nconst Creator: React.FC = () => {\n  const history = useHistory();\n  const { name, version } = useParams();\n  const [detail, setDetail] = useState<Package>({\n    name: '',\n    author: '',\n    version: '1.0.0',\n    description: '',\n    files: [],\n  });\n  useEffect(() => {\n    Axios.get(`/api/getPackage?name=${name}&version=${version}`).then((res) => {\n      setDetail(res.data.data);\n    });\n  }, [name, version]);\n\n  const [code, setCode] = useState('');\n\n  const [files, setFiles] = useState<FileItem[]>([]);\n  const [readmes, setReadmes] = useState<ReadmeNullItem[]>([]);\n\n  const [rule, setRule] = useState({\n    prefix: '',\n    content: '',\n    suffix: '',\n  });\n  useEffect(() => {\n    Axios.get('/api/getSetting').then((res) => {\n      if (res.data) {\n        setRule(res.data);\n      } else {\n        message.error('未设置规则，即将跳转设置！');\n        setTimeout(() => {\n          history.push('/settings');\n        }, 3000);\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    createForm(code, getRuleReg(rule));\n  }, [rule, code]);\n\n  // 加载云端文件\n  useEffect(() => {\n    if (detail.files.length > 0) {\n      Axios.all(detail.files.map((item) => Axios.get(item.template.url))).then(\n        Axios.spread(function (...props) {\n          // Both requests are now complete\n          setFiles(\n            props.map((item, index) => ({\n              name: detail.files[index].template.name,\n              code: item.data,\n              description: detail.files[index].description,\n            }))\n          );\n          setCodeCtn(props[0].data);\n        }),\n        () => {\n          message.error('模版文件加载失败');\n        }\n      );\n      // 加载readme\n      Axios.all(\n        detail.files.map((item) =>\n          item.readme ? Axios.get(item.readme.url) : null\n        )\n      ).then(\n        Axios.spread(function (...props) {\n          console.log(props);\n          // Both requests are now complete\n          setReadmes(\n            props.map((item, index) =>\n              item\n                ? {\n                    name: detail.files[index].readme.name,\n                    content: item.data,\n                  }\n                : null\n            )\n          );\n          // setCodeCtn(props[0].data);\n        }),\n        () => {\n          message.error('readme加载失败');\n        }\n      );\n    }\n  }, [detail.files]);\n\n  //#region  tab控制\n  const [index, setIndex] = useState(0);\n\n  const handleTabChange = (key: string) => {\n    setIndex(Number(key));\n  };\n\n  // 设置code\n  useEffect(() => {\n    if (files && files.length > 0) {\n      setCodeCtn(files[Number(index)].code);\n    }\n  }, [index, files]);\n  //#endregion\n\n  /** 设置代码，高亮，更新表单 */\n  const setCodeCtn = (code: string) => {\n    setCode(code);\n    createForm(code, getRuleReg(rule));\n    setTimeout(Prism.highlightAll, 0);\n  };\n\n  //#region 表单相关\n  const [form] = Form.useForm();\n  const [formValues, setFormValues] = useState<Record<string, string>[]>([]);\n\n  /** 分析代码，生成表单 */\n  const createForm = (code: string, rule: string) => {\n    if (code && rule) {\n      if (formValues[index]) {\n        form.setFieldsValue(formValues[index]);\n      } else {\n        const res = code.match(new RegExp(rule, 'gm'));\n        const newFormValues = [...formValues];\n        if (res) {\n          newFormValues[index] = outputFormValue(res);\n          form.setFieldsValue(newFormValues[index]);\n        } else {\n          newFormValues[index] = {};\n          form.resetFields();\n          message.error('代码中不存在插槽！');\n        }\n        setFormValues(newFormValues);\n      }\n    }\n  };\n\n  const handleValueChange = useCallback(\n    (changeValue: any) => {\n      const newFormValues = [...formValues];\n      newFormValues[index] = { ...newFormValues[index], ...changeValue };\n      setFormValues(newFormValues);\n      // 设置表单数据\n      form.setFieldsValue(newFormValues[index]);\n    },\n    [formValues, index]\n  );\n\n  /** 设置插槽高亮 */\n  const [currentFormItem, setCurrentFormItem] = useState('');\n\n  const renderForm = useCallback(\n    (formValues: Record<string, string> = {}) =>\n      Object.keys(formValues).map((item) => (\n        <Form.Item name={item} key={item} label={item} required>\n          <Input\n            placeholder=\"请输入\"\n            onFocus={() => setCurrentFormItem(item)}\n          ></Input>\n        </Form.Item>\n      )),\n    [handleValueChange]\n  );\n  const formElement = useMemo(\n    () => (formValues.length > 0 ? renderForm(formValues[index]) : ''),\n    [formValues, renderForm, index]\n  );\n\n  /** 继承插槽值 */\n  const handleExtendsFormValues = (value: any) => {\n    const formValue = formValues[Number(value)];\n    const newFormValues = [...formValues];\n    newFormValues[index] = { ...formValues[index], ...formValue };\n    setFormValues(newFormValues);\n    form.setFieldsValue(newFormValues[index]);\n  };\n  //#endregion\n\n  //#region  导入代码相关\n  const [visible, setVisible] = useState(false);\n  const [tempCode, setTempCode] = useState('');\n  const showCodeModal = () => {\n    setVisible(true);\n    setTempCode(code);\n  };\n  const modalConfirm = () => {\n    setCodeCtn(tempCode);\n    setVisible(false);\n  };\n  const modalCancel = () => {\n    setTempCode('');\n    setVisible(false);\n  };\n  //#endregion\n\n  /** 代码高亮 */\n  const setHightLight = () => {\n    setCurrentFormItem('');\n    setTimeout(Prism.highlightAll, 0);\n  };\n\n  //#region 本地规则抽屉\n  const [dvisible, setDVisible] = useState(false);\n\n  //#endregion\n\n  return (\n    <div style={{ display: 'flex', height: '100%', padding: 20, flex: 1 }}>\n      <Card\n        style={{\n          flex: 1,\n          display: 'flex',\n          flexDirection: 'column',\n          overflow: 'auto',\n        }}\n        headStyle={{ flexShrink: 0 }}\n        title=\"代码预览区域\"\n        extra={\n          <div>\n            {currentFormItem !== '' && (\n              <Button onClick={setHightLight}>代码高亮</Button>\n            )}\n            <Button type=\"primary\" onClick={showCodeModal}>\n              导入/编辑代码\n            </Button>\n            <CopyToClipboard\n              text={\n                formValues.length > 0 &&\n                outputCode(formValues[index], code, rule)\n              }\n              onCopy={() => message.success('复制成功')}\n            >\n              <Button type=\"primary\">复制代码</Button>\n            </CopyToClipboard>\n            <Button\n              type=\"primary\"\n              onClick={() => exportPatch(files, formValues, rule)}\n            >\n              导出模版\n            </Button>\n            <Button type=\"primary\" onClick={() => setDVisible(true)}>\n              设置临时规则\n            </Button>\n          </div>\n        }\n      >\n        <Descriptions title=\"基本信息\">\n          <Descriptions.Item label=\"作者\">{detail.author}</Descriptions.Item>\n          <Descriptions.Item label=\"版本\">{detail.version}</Descriptions.Item>\n          <Descriptions.Item label=\"简介\">\n            {detail.description}\n          </Descriptions.Item>\n        </Descriptions>\n        {files && files.length > 0 && (\n          <Tabs defaultActiveKey={String(index)} onChange={handleTabChange}>\n            {files.map((item, index) => (\n              <TabPane tab={item.name} key={String(index)}>\n                <h3>简介： {item.description || '暂无'}</h3>\n                <pre className={` language-${item.name.split('.')[1]}`}>\n                  <code\n                    className={`language-${item.name.split('.')[1]}`}\n                    dangerouslySetInnerHTML={{\n                      __html:\n                        formValues.length > 0\n                          ? showCode(\n                              formValues[index],\n                              code,\n                              currentFormItem,\n                              rule\n                            )\n                          : '',\n                    }}\n                  ></code>\n                </pre>\n                {readmes[index] && (\n                  <Card title={<div style={{ color: '#1890ff' }}>Readme</div>}>\n                    <div\n                      className=\"markdown\"\n                      dangerouslySetInnerHTML={{\n                        __html: DOMPurify.sanitize(\n                          marked(readmes[index]?.content || '')\n                        ),\n                      }}\n                    ></div>\n                  </Card>\n                )}\n              </TabPane>\n            ))}\n          </Tabs>\n        )}\n      </Card>\n      <Card\n        title={`【${files[index]?.name}】配置`}\n        style={{ width: '500px', marginLeft: 20 }}\n        extra={\n          <Button\n            type=\"primary\"\n            onClick={() =>\n              exportTemplate(files[index], formValues[index], rule)\n            }\n          >\n            导出当前文件\n          </Button>\n        }\n      >\n        <div>\n          <Form\n            form={form}\n            labelCol={{ span: 8 }}\n            onValuesChange={(changeValue) => handleValueChange(changeValue)}\n          >\n            {index > 0 && (\n              <Form.Item label=\"插槽值继承\">\n                <Select\n                  placeholder=\"选择模版插槽继承\"\n                  onSelect={(value) => handleExtendsFormValues(value)}\n                  allowClear\n                >\n                  {files.map((item, i) => (\n                    <Select.Option key={i} value={i} disabled={i === index}>\n                      {item.name}\n                    </Select.Option>\n                  ))}\n                </Select>\n              </Form.Item>\n            )}\n            {formElement}\n          </Form>\n        </div>\n      </Card>\n      <Drawer\n        title=\"临时规则设置\"\n        placement=\"right\"\n        width={400}\n        closable={false}\n        onClose={() => setDVisible(false)}\n        visible={dvisible}\n      >\n        <RuleForm\n          {...rule}\n          onConfirm={(value: any) => {\n            setDVisible(false);\n            setRule(value);\n          }}\n        ></RuleForm>\n      </Drawer>\n      <Modal\n        visible={visible}\n        title=\"导入代码【可编辑】\"\n        onOk={modalConfirm}\n        onCancel={modalCancel}\n      >\n        <Input.TextArea\n          onChange={({ target }) => setTempCode(target.value)}\n          value={tempCode}\n          allowClear\n          autoSize={{ minRows: 10 }}\n        ></Input.TextArea>\n      </Modal>\n    </div>\n  );\n};\n\nexport default Creator;\n","import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { message } from 'antd';\nimport RuleForm from '../compoents/RuleForm';\n\nfunction updateSetting(values: any) {\n  axios.post('api/updateSetting', values).then(() => {\n    message.success('设置成功');\n  });\n}\n\nconst Setting: React.FC = () => {\n  const [rule, setRule] = useState({\n    prefix: '',\n    content: '',\n    suffix: '',\n  });\n  useEffect(() => {\n    axios.get('/api/getSetting').then((res) => {\n      setRule(res.data);\n    });\n  }, []);\n  return (\n    <div style={{ textAlign: 'center' }}>\n      <div\n        style={{\n          width: '680px',\n          margin: '0 auto',\n          backgroundColor: '#fff',\n          padding: 20,\n        }}\n      >\n        <RuleForm {...rule} onConfirm={updateSetting}></RuleForm>\n      </div>\n    </div>\n  );\n};\n\nexport default Setting;\n","import React from 'react';\nimport { Form, Input, Button, Upload, message } from 'antd';\nimport { UploadProps } from 'antd/es/upload';\nimport {\n  UploadOutlined,\n  PlusOutlined,\n  MinusCircleOutlined,\n} from '@ant-design/icons';\nimport axios from 'axios';\nimport { useHistory } from 'react-router-dom';\n\ninterface MyUploadProps extends UploadProps {\n  value?: string;\n  onChange?(info: any): void;\n}\nconst MyUpload: React.FC<MyUploadProps> = (props) => {\n  const { value, onChange, ...others } = props;\n  const handleChange = (info: any) => {\n    if (info.file.status !== 'uploading') {\n      console.log(info.file, info.fileList);\n    }\n    if (info.file.status === 'done') {\n      onChange &&\n        onChange({ name: info.file.name, url: info.file.response.data.url });\n      message.success(`${info.file.name} file uploaded successfully`);\n    } else if (info.file.status === 'error') {\n      message.error(`${info.file.name} file upload failed.`);\n    }\n  };\n  const handleRemove = () => {\n    onChange && onChange('');\n  };\n  return (\n    <Upload {...others} onChange={handleChange} onRemove={handleRemove}>\n      {!value && (\n        <Button>\n          <UploadOutlined /> 点击上传\n        </Button>\n      )}\n    </Upload>\n  );\n};\n\ninterface TemplateFile {\n  file: any;\n  description: string;\n  readme: any;\n}\n\ninterface Package {\n  name: string;\n  author: string;\n  version: string;\n  files: TemplateFile[];\n}\n\nconst TemplateUpload: React.FC = () => {\n  const [form] = Form.useForm();\n\n  const history = useHistory();\n\n  const uploadConfig = {\n    name: 'file',\n    action: '/api/upload',\n  };\n\n  function savePackage(values: any) {\n    console.log(values);\n    axios.post('/api/savePackage', values).then((res) => {\n      if (!res.data.success) {\n        message.error(res.data.message);\n      } else {\n        message.success('操作成功，跳转中...');\n        setTimeout(() => {\n          history.push('/');\n        }, 1000);\n      }\n    });\n  }\n  return (\n    <div\n      style={{\n        height: '100%',\n        overflowY: 'auto',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n      }}\n    >\n      <div\n        style={{\n          width: '680px',\n          margin: '0 auto',\n          backgroundColor: '#fff',\n          padding: 20,\n        }}\n      >\n        <h1 style={{ textAlign: 'center' }}>创建模版</h1>\n        <p style={{ textAlign: 'right' }}>磨刀不误砍柴工</p>\n        <Form form={form} labelCol={{ span: 4 }} onFinish={savePackage}>\n          <Form.Item\n            name='name'\n            label='模版名'\n            rules={[{ required: true, message: '请输入模版名！' }]}\n          >\n            <Input></Input>\n          </Form.Item>\n          <Form.Item name='description' label='概要'>\n            <Input.TextArea autoSize={{ minRows: 2 }}></Input.TextArea>\n          </Form.Item>\n          <Form.Item\n            name='version'\n            label='版本号'\n            rules={[{ required: true, message: '请输入版本号！' }]}\n          >\n            <Input></Input>\n          </Form.Item>\n          <Form.Item\n            name='author'\n            label='作者'\n            rules={[{ required: true, message: '请输入作者！' }]}\n          >\n            <Input></Input>\n          </Form.Item>\n          <Form.List name='files'>\n            {(fields, { add, remove }) => {\n              return (\n                <div>\n                  {fields.map((field, index) => (\n                    <div key={field.key} className='template-ctn'>\n                      <p className='template-title'>模版文件{index + 1}</p>\n                      <Form.Item\n                        name={[field.name, 'template']}\n                        // fieldKey={[field.fieldKey, 'template']}\n                        label='模版文件'\n                        rules={[{ required: true, message: '请上传模版！' }]}\n                      >\n                        <MyUpload\n                          {...uploadConfig}\n                          // onChange={FileUploadProvider(index, 'template')}\n                        ></MyUpload>\n                      </Form.Item>\n                      <Form.Item\n                        name={[field.name, 'description']}\n                        // fieldKey={[field.fieldKey, 'description']}\n                        label='简介'\n                      >\n                        <Input.TextArea\n                          autoSize={{ minRows: 2 }}\n                        ></Input.TextArea>\n                      </Form.Item>\n                      <Form.Item\n                        name={[field.name, 'readme']}\n                        // fieldKey={[field.fieldKey, 'readme']}\n                        label='说明文档(md)'\n                      >\n                        <MyUpload\n                          {...uploadConfig}\n                          accept='.md'\n                          // onChange={FileUploadProvider(index, 'template')}\n                        ></MyUpload>\n                      </Form.Item>\n                      {fields.length > 1 ? (\n                        <MinusCircleOutlined\n                          className='dynamic-delete-button'\n                          style={{ margin: '0 8px' }}\n                          onClick={() => {\n                            remove(field.name);\n                          }}\n                        />\n                      ) : (\n                        ''\n                      )}\n                    </div>\n                  ))}\n                  <Form.Item label='模版'>\n                    <Button\n                      type='dashed'\n                      onClick={() => {\n                        add();\n                      }}\n                      style={{ width: '60%', marginTop: 10 }}\n                    >\n                      <PlusOutlined /> 添加模版\n                    </Button>\n                  </Form.Item>\n                </div>\n              );\n            }}\n          </Form.List>\n          <Form.Item style={{ textAlign: 'center' }}>\n            <Button type='primary' htmlType='submit'>\n              保存\n            </Button>\n          </Form.Item>\n        </Form>\n      </div>\n    </div>\n  );\n};\n\nexport default TemplateUpload;\n","import React, { useState, useEffect } from 'react';\nimport { Card, Row, Col, Empty, Input } from 'antd';\nimport { EditOutlined } from '@ant-design/icons';\nimport { useHistory } from 'react-router-dom';\nimport axios from 'axios';\nimport { Package } from './types';\n\nconst List: React.FC = () => {\n  const [list, setList] = useState<Package[]>([]);\n  const history = useHistory();\n  useEffect(() => {\n    axios.get('/api/list').then((res) => {\n      setList(res.data);\n    });\n  }, []);\n  // 筛选\n  const [query, setQuery] = useState('');\n\n  return (\n    <div>\n      <div>\n        <Input\n          size='large'\n          style={{ width: '300px', marginLeft: 10 }}\n          value={query}\n          onChange={({ target }) => setQuery(target.value)}\n          placeholder='请输入模版名搜索'\n        ></Input>\n      </div>\n      <Row>\n        {list && list.length > 0 ? (\n          list\n            .filter((item) => item.name.indexOf(query) !== -1)\n            .map((item) => (\n              <Col\n                key={item.name}\n                xs={24}\n                sm={24}\n                md={12}\n                lg={6}\n                style={{ padding: 10 }}\n              >\n                <Card\n                  title={item.name}\n                  extra={item.version}\n                  onClick={() =>\n                    history.push(`/creator/${item.name}/${item.version}`)\n                  }\n                  className=\"package-card\"\n                  actions={[\n                    <EditOutlined\n                      key='edit'\n                      onClick={(e: React.MouseEvent) => {\n                        e.stopPropagation();\n                        history.push(\n                          `/editPackage/${item.name}/${item.version}`\n                        );\n                      }}\n                    />,\n                  ]}\n                >\n                  <pre>{item.description || '暂无简介'}</pre>\n                  <p style={{ textAlign: 'right' }}>作者：{item.author}</p>\n                </Card>\n              </Col>\n            ))\n        ) : (\n          <Empty></Empty>\n        )}\n      </Row>\n    </div>\n  );\n};\n\nexport default List;\n","import React, { useState, useCallback, useMemo, useEffect } from 'react';\r\nimport { Form, Input, Modal, Button, message, Card, Drawer } from 'antd';\r\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\r\nimport Axios from 'axios';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { getRuleReg } from '../utils/index';\r\nimport RuleForm from '../compoents/RuleForm';\r\n// import Prism from 'prismjs';\r\n// import useRequest from '../hooks/useRequest';\r\n\r\nfunction outputFormValue(array: string[]) {\r\n  const has: Record<string, string | undefined> = {};\r\n  array.forEach((item) => {\r\n    if (has[item] === undefined) {\r\n      has[item] = '';\r\n    }\r\n  });\r\n  return has;\r\n}\r\n\r\nfunction showCode(\r\n  form: Record<string, string>,\r\n  code: string,\r\n  currentFormItem = '',\r\n  rule = {\r\n    prefix: '{{',\r\n    suffix: '}}',\r\n  }\r\n) {\r\n  if (code && form) {\r\n    let rs = code;\r\n    Object.keys(form).forEach((item) => {\r\n      rs = rs.replace(\r\n        new RegExp(`${rule.prefix}${item}${rule.suffix}`, 'gm'),\r\n        `<span class=\"slot-${item} ${\r\n          item === currentFormItem ? 'actived-code' : ''\r\n        }\">${form[item] || ' '}</span>`\r\n      );\r\n    });\r\n    return rs;\r\n  }\r\n  return '';\r\n}\r\n\r\nfunction outputCode(\r\n  form: Record<string, string> = {},\r\n  code: string = '',\r\n  rule = {\r\n    prefix: '{{',\r\n    suffix: '}}',\r\n  }\r\n) {\r\n  let rs = code;\r\n  Object.keys(form).forEach((item) => {\r\n    rs = rs.replace(\r\n      new RegExp(`${rule.prefix}${item}${rule.suffix}`, 'gm'),\r\n      form[item]\r\n    );\r\n  });\r\n  return rs;\r\n}\r\n\r\nconst Creator: React.FC = () => {\r\n  const history = useHistory();\r\n  const [code, setCode] = useState('');\r\n\r\n  //#region 获取规则\r\n  const [rule, setRule] = useState({\r\n    prefix: '',\r\n    content: '',\r\n    suffix: '',\r\n  });\r\n  useEffect(() => {\r\n    Axios.get('/api/getSetting').then((res) => {\r\n      if (res.data) {\r\n        setRule(res.data);\r\n      } else {\r\n        message.error('未设置规则，即将跳转设置！');\r\n        setTimeout(() => {\r\n          history.push('/settings');\r\n        }, 3000);\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    createForm(code, getRuleReg(rule));\r\n  }, [rule, code]);\r\n\r\n  /** 分析代码，生成表单 */\r\n  const createForm = (code: string, rule: string) => {\r\n    if (code && rule) {\r\n      const res = code.match(new RegExp(rule, 'gm'));\r\n      if (res) {\r\n        setFormValues(outputFormValue(res));\r\n      } else {\r\n        message.error('代码中不存在插槽！');\r\n      }\r\n    }\r\n  };\r\n\r\n  /** 设置代码，高亮，更新表单 */\r\n  const setCodeCtn = (code: string) => {\r\n    setCode(code);\r\n    createForm(code, getRuleReg(rule));\r\n    setTimeout(Prism.highlightAll, 0);\r\n  };\r\n\r\n  //#region 表单相关\r\n  const [formValues, setFormValues] = useState({});\r\n\r\n  const handleValueChange = useCallback(\r\n    (changeValue: any) => {\r\n      setFormValues({ ...formValues, ...changeValue });\r\n    },\r\n    [formValues]\r\n  );\r\n\r\n  /** 设置插槽高亮 */\r\n  const [currentFormItem, setCurrentFormItem] = useState('');\r\n\r\n  const renderForm = useCallback(\r\n    (formValues: Record<string, string>) => (\r\n      <Form\r\n        labelCol={{ span: 8 }}\r\n        onValuesChange={(changeValue) => handleValueChange(changeValue)}\r\n      >\r\n        {Object.keys(formValues).map((item) => (\r\n          <Form.Item name={item} key={item} label={item} required>\r\n            <Input\r\n              placeholder=\"请输入\"\r\n              onFocus={() => setCurrentFormItem(item)}\r\n            ></Input>\r\n          </Form.Item>\r\n        ))}\r\n      </Form>\r\n    ),\r\n    [handleValueChange]\r\n  );\r\n  const form = useMemo(() => renderForm(formValues), [formValues, renderForm]);\r\n  //#endregion\r\n\r\n  //#region  导入代码相关\r\n  const [visible, setVisible] = useState(false);\r\n  const [tempCode, setTempCode] = useState('');\r\n  const showCodeModal = () => {\r\n    setVisible(true);\r\n    setTempCode(code);\r\n  };\r\n  const modalConfirm = () => {\r\n    setCodeCtn(tempCode);\r\n    setVisible(false);\r\n  };\r\n  const modalCancel = () => {\r\n    setTempCode('');\r\n    setVisible(false);\r\n  };\r\n  //#endregion\r\n\r\n  const setHightLight = () => {\r\n    setCurrentFormItem('');\r\n    setTimeout(Prism.highlightAll, 0);\r\n  };\r\n\r\n  //#region 本地规则抽屉\r\n  const [dvisible, setDVisible] = useState(false);\r\n\r\n  //#endregion\r\n\r\n  return (\r\n    <div style={{ display: 'flex', height: '100%', padding: 20 }}>\r\n      <Card\r\n        style={{ flex: 1 }}\r\n        title=\"代码预览区域\"\r\n        extra={\r\n          <div>\r\n            {currentFormItem !== '' && (\r\n              <Button onClick={setHightLight}>代码高亮</Button>\r\n            )}\r\n            <Button type=\"primary\" onClick={showCodeModal}>\r\n              导入/编辑代码\r\n            </Button>\r\n            <CopyToClipboard\r\n              text={outputCode(formValues, code, rule)}\r\n              onCopy={() => message.success('复制成功')}\r\n            >\r\n              <Button type=\"primary\">复制代码</Button>\r\n            </CopyToClipboard>\r\n            <Button type=\"primary\" onClick={() => setDVisible(true)}>\r\n              设置临时规则\r\n            </Button>\r\n          </div>\r\n        }\r\n      >\r\n        <pre className=\" language-tsx\">\r\n          {React.createElement('code', {\r\n            className: 'language-tsx',\r\n            dangerouslySetInnerHTML: {\r\n              __html: code\r\n                ? showCode(formValues, code, currentFormItem, rule)\r\n                : '请导入代码',\r\n            },\r\n          })}\r\n        </pre>\r\n      </Card>\r\n      <Card title=\"模版代码配置\" style={{ width: '500px', marginLeft: 20 }}>\r\n        <div>{form}</div>\r\n      </Card>\r\n      <Modal\r\n        visible={visible}\r\n        title=\"导入代码【可编辑】\"\r\n        onOk={modalConfirm}\r\n        onCancel={modalCancel}\r\n      >\r\n        <Input.TextArea\r\n          onChange={({ target }) => setTempCode(target.value)}\r\n          value={tempCode}\r\n          allowClear\r\n          autoSize={{ minRows: 10 }}\r\n        ></Input.TextArea>\r\n      </Modal>\r\n      <Drawer\r\n        title=\"临时规则设置\"\r\n        placement=\"right\"\r\n        width={400}\r\n        closable={false}\r\n        onClose={() => setDVisible(false)}\r\n        visible={dvisible}\r\n      >\r\n        <RuleForm\r\n          {...rule}\r\n          onConfirm={(value: any) => {\r\n            setDVisible(false);\r\n            setRule(value);\r\n          }}\r\n        ></RuleForm>\r\n      </Drawer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Creator;\r\n","import React, { useEffect, useState } from 'react';\nimport { Form, Input, Button, Upload, message, Spin } from 'antd';\nimport { UploadProps } from 'antd/es/upload';\nimport {\n  UploadOutlined,\n  PlusOutlined,\n  MinusCircleOutlined,\n} from '@ant-design/icons';\nimport axios from 'axios';\nimport { useParams, useHistory } from 'react-router-dom';\n\ninterface MyUploadProps extends UploadProps {\n  value?: {\n    name: string;\n    url: string;\n  }[];\n  onChange?(info: any): void;\n}\nconst MyUpload: React.FC<MyUploadProps> = (props) => {\n  const { value, onChange, ...others } = props;\n  const handleChange = (info: any) => {\n    if (info.file.status !== 'uploading') {\n      console.log(info.file, info.fileList);\n    }\n    if (info.file.status === 'done') {\n      onChange &&\n        onChange([{ name: info.file.name, url: info.file.response.data.url }]);\n      message.success(`${info.file.name} file uploaded successfully`);\n    } else if (info.file.status === 'error') {\n      message.error(`${info.file.name} file upload failed.`);\n    }\n  };\n  const handleRemove = () => {\n    onChange && onChange([]);\n  };\n  return (\n    <Upload\n      {...others}\n      onChange={handleChange}\n      onRemove={handleRemove}\n      defaultFileList={\n        value?.map((item, index) => ({\n          uid: index,\n          ...item,\n          fileName: item.name,\n        })) as any\n      }\n    >\n      {value?.length === 0 && (\n        <Button>\n          <UploadOutlined /> 点击上传\n        </Button>\n      )}\n    </Upload>\n  );\n};\n\ninterface TemplateFile {\n  file: any;\n  description: string;\n  readme: any;\n}\n\ninterface Package {\n  name: string;\n  author: string;\n  version: string;\n  files: TemplateFile[];\n}\n\nconst TemplateUpload: React.FC = () => {\n  const [form] = Form.useForm();\n  const history = useHistory();\n\n  const [ajaxing, setAjaxing] = useState(false);\n\n  const { name, version } = useParams();\n\n  const uploadConfig = {\n    name: 'file',\n    action: '/api/upload',\n  };\n\n  /** 保存package */\n  function savePackage(values: any) {\n    // 去除files的数组\n    const files = [...values.files];\n    for (let i = 0; i < files.length; i++) {\n      if (files[i].template?.length > 0) {\n        values.files[i].template = files[i].template[0];\n      }\n      if (files[i].readme.length > 0) {\n        values.files[i].readme = files[i].readme[0];\n      }\n    }\n    axios.post('/api/savePackage', values).then((res) => {\n      if (!res.data.success) {\n        message.error(res.data.message);\n      } else {\n        message.success('操作成功，跳转中...');\n        setTimeout(() => {\n          history.push('/');\n        }, 1000);\n      }\n    });\n  }\n\n  useEffect(() => {\n    setAjaxing(true);\n    axios.get(`/api/getPackage?name=${name}&version=${version}`).then((res) => {\n      console.log(res);\n      const myPackage = { ...res.data.data };\n      myPackage.files = myPackage.files.map((item: any) => ({\n        template: item.template ? [item.template] : [],\n        description: item.description,\n        readme: item.readme ? [item.readme] : [],\n      }));\n      form.setFieldsValue(myPackage);\n      setAjaxing(false);\n    });\n  }, [name, version]);\n  return (\n    <div\n      style={{\n        height: '100%',\n        overflowY: 'auto',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n      }}\n    >\n      {ajaxing ? (\n        <Spin size='large'></Spin>\n      ) : (\n        <div\n          style={{\n            width: '680px',\n            margin: '0 auto',\n            backgroundColor: '#fff',\n            padding: 20,\n          }}\n        >\n          <p style={{ color: 'red', fontSize: 12, textAlign: 'center' }}>\n            编辑模版，请注意升级版本\n          </p>\n          <Form form={form} labelCol={{ span: 4 }} onFinish={savePackage}>\n            <Form.Item\n              name='name'\n              label='模版名'\n              rules={[{ required: true, message: '请输入模版名！' }]}\n            >\n              <Input></Input>\n            </Form.Item>\n            <Form.Item name='description' label='概要'>\n              <Input.TextArea autoSize={{ minRows: 2 }}></Input.TextArea>\n            </Form.Item>\n            <Form.Item\n              name='version'\n              label='版本号'\n              rules={[{ required: true, message: '请输入版本号！' }]}\n            >\n              <Input></Input>\n            </Form.Item>\n            <Form.Item\n              name='author'\n              label='作者'\n              rules={[{ required: true, message: '请输入作者！' }]}\n            >\n              <Input></Input>\n            </Form.Item>\n            <Form.List name='files'>\n              {(fields, { add, remove }) => {\n                return (\n                  <div>\n                    {fields.map((field, index) => (\n                      <div key={field.key} className='template-ctn'>\n                        <p className='template-title'>模版文件{index + 1}</p>\n                        <Form.Item\n                          name={[field.name, 'template']}\n                          // fieldKey={[field.fieldKey, 'template']}\n                          label='模版文件'\n                          rules={[{ required: true, message: '请上传模版！' }]}\n                        >\n                          <MyUpload\n                            {...uploadConfig}\n                            // onChange={FileUploadProvider(index, 'template')}\n                          ></MyUpload>\n                        </Form.Item>\n                        <Form.Item\n                          name={[field.name, 'description']}\n                          // fieldKey={[field.fieldKey, 'description']}\n                          label='简介'\n                        >\n                          <Input.TextArea\n                            autoSize={{ minRows: 2 }}\n                          ></Input.TextArea>\n                        </Form.Item>\n                        <Form.Item\n                          name={[field.name, 'readme']}\n                          // fieldKey={[field.fieldKey, 'readme']}\n                          label='说明文档(md)'\n                        >\n                          <MyUpload\n                            {...uploadConfig}\n                            accept='.md'\n                            // onChange={FileUploadProvider(index, 'template')}\n                          ></MyUpload>\n                        </Form.Item>\n                        {fields.length > 1 ? (\n                          <MinusCircleOutlined\n                            className='dynamic-delete-button'\n                            style={{ margin: '0 8px' }}\n                            onClick={() => {\n                              remove(field.name);\n                            }}\n                          />\n                        ) : (\n                          ''\n                        )}\n                      </div>\n                    ))}\n                    <Form.Item label='模版'>\n                      <Button\n                        type='dashed'\n                        onClick={() => {\n                          add();\n                        }}\n                        style={{ width: '60%', marginTop: 10 }}\n                      >\n                        <PlusOutlined /> 添加模版\n                      </Button>\n                    </Form.Item>\n                  </div>\n                );\n              }}\n            </Form.List>\n            <Form.Item style={{ textAlign: 'center' }}>\n              <Button type='primary' htmlType='submit'>\n                保存\n              </Button>\n            </Form.Item>\n          </Form>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TemplateUpload;\n","import React from 'react';\nimport { Switch, Route } from 'react-router-dom';\nimport Creator from './pages/creator';\nimport Setting from './pages/settings';\nimport Upload from './pages/upload';\nimport List from './pages/list';\nimport LocalCode from './pages/localCode';\nimport EditPackage from './pages/editPackage';\n\nconst Routes = () => (\n    <Switch>\n      <Route exact path=\"/creator/:name/:version\">\n        <Creator></Creator>\n      </Route>\n      <Route exact path=\"/ezcode\">\n        <LocalCode></LocalCode>\n      </Route>\n      <Route exact path=\"/settings\">\n        <Setting></Setting>\n      </Route>\n      <Route exact path=\"/upload\">\n        <Upload></Upload>\n      </Route>\n      <Route exact path=\"/editPackage/:name/:version\">\n        <EditPackage></EditPackage>\n      </Route>\n      <Route exact path=\"/\">\n        <List></List>\n      </Route>\n    </Switch>\n);\n\nexport default Routes;\n","import React from 'react';\nimport { Layout, Menu, Tooltip } from 'antd';\nimport { Link, BrowserRouter as Router } from 'react-router-dom';\nimport Routes from './router';\n\nfunction App() {\n  return (\n    <Router>\n      <Layout style={{ height: '100vh' }}>\n        <Layout.Header className='header'>\n          <Tooltip\n            overlay={\n              <div>\n                design by ccc\n                <div>\n                  <a href='mailto:vic.c2@outlook.com'>\n                    咨询/反馈：vic.c2@outlook.com\n                  </a>\n                </div>\n              </div>\n            }\n            placement='bottom'\n          >\n            <h1 style={{ color: '#fff', marginRight: 60 }}>代码生成器</h1>\n          </Tooltip>\n\n          <Menu mode='horizontal' theme='dark'>\n            <Menu.Item>\n              <Link to='/'>模版列表</Link>\n            </Menu.Item>\n            <Menu.Item>\n              <Link to='/ezcode'>本地操作台</Link>\n            </Menu.Item>\n            <Menu.Item>\n              <Link to='/settings'>设置</Link>\n            </Menu.Item>\n            <Menu.Item>\n              <Link to='/upload'>上传模版</Link>\n            </Menu.Item>\n          </Menu>\n        </Layout.Header>\n        <Layout.Content style={{ padding: 20, textAlign: 'left' }}>\n          <Routes></Routes>\n        </Layout.Content>\n      </Layout>\n    </Router>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}